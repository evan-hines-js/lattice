# OpenStack workload2 cluster for E2E hierarchy and multi-pool testing
# Provisioned from workload1 to test deep cluster hierarchy and multiple worker pools
apiVersion: lattice.dev/v1alpha1
kind: LatticeCluster
metadata:
  name: e2e-workload2
spec:
  provider:
    kubernetes:
      version: "1.32.0"
      bootstrap: kubeadm
      certSANs:
        - "127.0.0.1"
        - "localhost"
    config:
      openstack:
        externalNetworkId: "Ext-Net"
        cpFlavor: "b2-30"
        workerFlavor: "b2-15"
        imageName: "Ubuntu 22.04"
        sshKeyName: "lattice-e2e"
        cloudName: "openstack"
        dnsNameservers:
          - "8.8.8.8"
          - "8.8.4.4"
        cpRootVolumeSizeGb: 50
        workerRootVolumeSizeGb: 50
  nodes:
    controlPlane: 1
    workerPools:
      general:
        replicas: 1
        labels:
          workload-type: general
      compute:
        replicas: 1
        labels:
          workload-type: compute
        nodeClass: b2-30
  parentConfig:
    # host is auto-discovered from Octavia LB
    grpcPort: 50051
    bootstrapPort: 8443
    service:
      type: LoadBalancer
  environment: e2e-test
  region: local
