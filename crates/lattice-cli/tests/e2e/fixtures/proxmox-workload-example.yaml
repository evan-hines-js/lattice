# Proxmox workload cluster example
# Copy this file and fill in your values
#
# This cluster will be provisioned by the management cluster.
# Make sure the VIP and IP addresses don't conflict with the management cluster.
apiVersion: lattice.dev/v1alpha1
kind: LatticeCluster
metadata:
  name: workload-cluster
spec:
  provider:
    kubernetes:
      version: "1.32.0"
      bootstrap: rke2
      certSANs:
        - "127.0.0.1"
        - "localhost"
        - "10.0.0.110"  # This cluster's VIP (different from mgmt)
    config:
      proxmox:
        # Credentials via secret reference (same secret as mgmt cluster)
        secretRef:
          name: proxmox-credentials
          namespace: lattice-system
        # Proxmox infrastructure settings
        sourceNode: "pve"
        templateId: 9000
        controlPlaneEndpoint: "10.0.0.110"  # Different VIP from mgmt
        storage: "local-lvm"
        bridge: "vmbr0"
        # IP allocation (different from mgmt cluster IPs)
        ipv4Addresses:
          - "10.0.0.111"               # Control plane node
          - "10.0.0.112"               # Worker 1
          - "10.0.0.113"               # Worker 2
        ipv4Prefix: 24
        ipv4Gateway: "10.0.0.1"
        dnsServers:
          - "10.0.0.1"
        virtualIpNetworkInterface: "ens18"
        # VM sizing
        cpCores: 16
        cpMemoryMib: 32768
        cpDiskSizeGb: 50
        workerCores: 16
        workerMemoryMib: 32768
        workerDiskSizeGb: 100
        sshAuthorizedKeys:
          - "ssh-ed25519 AAAA... your-key"
  nodes:
    controlPlane: 1
    workers: 2
  environment: production
  region: proxmox
